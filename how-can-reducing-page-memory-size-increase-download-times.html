<!DOCTYPE html>
<html lang="en">

<head>
      <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>How can reducing page memory size increase download times?</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
  <link href="https://kiwidamien.github.io" rel="canonical" />

  <!-- Feed -->

  <link href="https://kiwidamien.github.io/theme/css/style.css" type="text/css" rel="stylesheet" />
  <link href="https://kiwidamien.github.io/theme/css/collapse.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="https://kiwidamien.github.io/theme/css/code_blocks/monokai.css" rel="stylesheet">
  
  <link href="https://kiwidamien.github.io/theme/css/code_blocks/notebook.css" rel="stylesheet">

    <!-- CSS specified by the user -->
    <link href="https://kiwidamien.github.io/assets/css/mystyle.css" type="text/css" rel="stylesheet" />


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->


    <link href="https://kiwidamien.github.io/how-can-reducing-page-memory-size-increase-download-times.html" rel="canonical" />

        <meta name="description" content="In 2009, YouTube made improvements which reduced the video player from 1.2MB to 98kB. However, the time taken to download the page...">

        <meta name="author" content="Damien Martin">

        <meta name="tags" content="Metrics">
        <meta name="tags" content="Simpson's paradox">
        <meta name="tags" content="aggregation">
        <meta name="tags" content="confounding">

        <meta property="og:locale" content="" />
    <meta property="og:site_name" content="Stacked Turtles" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Stacked Turtles" />
    <meta property="og:description" content="View the blog." />
    <meta property="og:url" content="https://kiwidamien.github.io" />
      <meta property="og:image" content="https://kiwidamien.github.io/assets/images/tools.png" />

  <meta property="og:type" content="article">
            <meta property="article:author" content="https://kiwidamien.github.io/author/damien-martin.html">
  <meta property="og:url" content="https://kiwidamien.github.io/how-can-reducing-page-memory-size-increase-download-times.html">
  <meta property="og:title" content="How can reducing page memory size increase download times?">
  <meta property="article:published_time" content="2020-06-06 23:00:00-07:00">
            <meta property="og:description" content="In 2009, YouTube made improvements which reduced the video player from 1.2MB to 98kB. However, the time taken to download the page...">

            <meta property="og:image" content="https://kiwidamien.github.io/assets/images/tools.png">
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="https://kiwidamien.github.io/about.html" role="presentation">About this blog</a></li>
          <li><a href="http://slashdot.org" role="presentation">slashdot</a></li>
          <li><a href="https://thisismetis.com" role="presentation">metis</a></li>
          <li><a href="https://stackoverflow.com" role="presentation">stackoverflow</a></li>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="https://kiwidamien.github.io" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">How can reducing page memory size increase download times?</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="https://kiwidamien.github.io/author/damien-martin.html">Damien martin</a>
            | <time datetime="Sat 06 June 2020">Sat 06 June 2020</time>
        </span>
        <span class="post-meta">
          Filed under: <b><a href="https://kiwidamien.github.io/category/data-science.html">Data science</a></b>
        </span>

        <!-- TODO : Modified check -->


    <div class="post-cover cover" style="background-image: url('assets/images/tools.png')">

</div>
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
		    <p>This post is part 1 of the "Simpson's Paradox" series:</p>
    		    <ol class="parts">
            	        <li class="active">
                          <a href='https://kiwidamien.github.io/how-can-reducing-page-memory-size-increase-download-times.html'>How can reducing page memory size increase download times?</a>
                        </li>
                    </ol>
                
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">¶</a></h2><p>In 2009, Chris Zacharias thought that a 1.2MB video player YouTube was using was far larger than needed. As he points out in his amusing <a href="https://blog.chriszacharias.com/page-weight-matters">blog post</a>, full Quake clones were being written in under 100kB.</p>
<p>Part of this is an engineering challenge, but there is also business value to be derived as well. People still on 56kbps modems would have to wait approximately 3 minutes just to download the video player (let alone the video itself). In 2009, dial-up was uncommon in Silicon Valley and large urban areas like New York City, but was still common in more rural areas, and many countries overseas.</p>
<p>The load time was important enough for YouTube to track the average load time of the page as one of its key metrics. If this time got too long, users would lose patience and leave.</p>
<p>Chris spent three days improving the player, and got the page size down to 98kB, roughly 8% of the original download size! Paradoxically, Chris saw the average load time <em>increase</em> dramatically as a result. For most changes, this would be enough to do an immediate rollback (after checking for errors in the analysis), but in this case the idea of making the download smaller leading to an increased average time was so bizzare that the team dug deeper.</p>
<blockquote><p>tl, dr; Download size is 8% of original, but download time is dramatically up</p>
</blockquote>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Everyone's-result-got-better-(but-this-wasn't-captured-in-the-metric)">Everyone's result got better (but this wasn't captured in the metric)<a class="anchor-link" href="#Everyone's-result-got-better-(but-this-wasn't-captured-in-the-metric)">¶</a></h2><p>Instead of taking a global average, which went up, we could look at the average download time per geographic region: North America, South America, Africa, Europe, Central Asia, South East Asia, and Oceania. In <em>every one</em> of those regions, the average time went down.</p>
<p>How can <em>every</em> region see a decrease in average time, but the <em>overall</em> average see an increase?</p>
<p>The answer lies in the participation rate. With the 1.2MB size, it would take people in Africa approximately 20 minutes to download the video player, and so not many people bothered. When the download was shrunk to 8% of the size, download the player took just under 2 minutes, and a lot more people from Africa used YouTube. This increase in participation from people who were not bothering to use the large downloads is enough to bring the overall average up!</p>
<h3 id="Example-numbers">Example numbers<a class="anchor-link" href="#Example-numbers">¶</a></h3><p>Chris's post didn't include any viewer statistics, so let's make up some numbers to show how this could happen. Let's limit ourselves to North America, Europe, and Africa (the story generalizes if we include South America, Asia, and Oceania as well, but we try to keep just a few regions so we can see what is going on).</p>
<p>When downloading something from the internet, there are three big factors that determine your waiting time:</p>
<ul>
<li>how fast your connection is (both your modem, and your provider),</li>
<li>how far away you are from the server,</li>
<li>size of the download</li>
</ul>
<p>Let's say we measure the average download time per region, and the number of monthly views in 2009 for the 1.2MB page</p>
<table>
<thead><tr>
<th>Region</th>
<th>Avg Download Time</th>
<th>Videos watched per month</th>
</tr>
</thead>
<tbody>
<tr>
<td>North America</td>
<td>2.5 s</td>
<td>6.3 Million</td>
</tr>
<tr>
<td>Europe</td>
<td>1.8 s</td>
<td>5.4 Million</td>
</tr>
<tr>
<td>Africa</td>
<td>20 minutes</td>
<td>0.01 Million</td>
</tr>
</tbody>
</table>
<p>This gives us an overall average download time of 3.2 seconds.</p>
<p>By making the download 8% of the size, the times should go to roughly 8% as well. The US and Europe see a mild increase in adoption, but not too many users were put off by the wait time. Africa sees a <em>huge</em> increase in people watching videos under the reduced wait time:</p>
<table>
<thead><tr>
<th>Region</th>
<th>Avg Download Time</th>
<th>Videos watched per month</th>
</tr>
</thead>
<tbody>
<tr>
<td>North America</td>
<td>0.3 s</td>
<td>6.9 Million</td>
</tr>
<tr>
<td>Europe</td>
<td>0.2 s</td>
<td>5.7 Million</td>
</tr>
<tr>
<td>Africa</td>
<td>1.6 minutes ~ 100 seconds</td>
<td>1.0 Million</td>
</tr>
</tbody>
</table>
<p>Taking the average of all these times now gives 7.6 seconds, more than double what we saw with the old download sizes. This is despite everyone getting shorter download times!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Selection-Bias">Selection Bias<a class="anchor-link" href="#Selection-Bias">¶</a></h3><p>This resolution may still "feel" wrong - if everyone gets a better deal, how can the average go up. If we were dealing with a class of students, and everyone got 10 more points on their test, this is enough information to tell us the class average must go up.</p>
<p>In the class example, everyone had exactly one grade. Any student increasing their grade (if there were no changes in other grades) raises the average. In the YouTube example, people can choose how many videos to watch (or whether to watch any at all). Because we can increase the number of views due to changing the loads, our intuition about averages doesn't work. We also have the regions with the longest download times having the greatest increase.</p>
<p>This is a form of <em>selection bias</em> : shorter download times will get more views. We often encounter selection bias when only getting certain groups, such as</p>
<ul>
<li>doing telephone polls for political survey (only selects people with phones, not all voters)</li>
<li>product launch in a major city (ignores differing preferences of people in rural areas, or other coast)</li>
<li>product feedback (only registers users that feel strongly and are comfortable leaving feedback)</li>
</ul>
<p>Each of these cases feel like, with better designed data sampling, you <em>could</em> have polled voters in a representative fashion, you <em>could</em> have launched your product in representative geographic areas, and (in principle) you could imagine collecting all the people that have bought a product to try and account for the bias.</p>
<h4 id="Why-our-example-feels-different">Why our example feels different<a class="anchor-link" href="#Why-our-example-feels-different">¶</a></h4><p>One way that the YouTube example is qualitatively different is that we are not "selecting" a bunch of video views, and happen to over-sample from North America and Europe. Instead, the clients with slow bandwidth in Africa are opting not to view as many videos, as it takes a long time for them to download. The actions of our <em>clients</em> are the ones that do the selection, and we cannot determine how many videos they <em>would</em> have watched if our downloads.</p>
<p>(We can make models that estimate it, however.)</p>
<p>Not being able to determine the "selection bias" is common when opening up your market to new segments. For example, if a delivery app was SF only, but then supports delivery in Arizona, we don't know ahead of time how much demand to expect from Arizona, and the total average value of an order may well go down, but we would probably segment by market, or by new vs existing users.</p>
<p>The YouTube example is a little different from this example as well, as we didn't open up to new users. Even looking at new vs old users wouldn't help here, as user's with slower internet would probably watch more videos. Even though there are some differences, hopefully these examples show why our intuition about averages from <em>fixed</em> populations leads us astray here. Even in fixed populations, the question is surprisingly subtle, as examples of <a href="simpsons-paradox">Simpsons paradox</a> show.</p>
<h4 id='A-common-problem:-"per-user"-metrics'>A common problem: "per user" metrics<a class="anchor-link" href='#A-common-problem:-"per-user"-metrics'>¶</a></h4><p>We have seen that, instead of looking at "average load time", we get a much better metric if we look at "average load time per region". If we looked at a metric like "number of videos watched", we would see that the smaller download size saw a significant increase of videos viewed.</p>
<p>We might be a little cautious about this metric, especially if our site is growing. If we are growing through marketing, word of month, and (in YouTube's case) a growth of content, a change that did nothing would still see an increase in "number of videos watched" increase.</p>
<p>One way of trying to solve this is to look at the number of videos watched <em>per user</em>, VWpU (as with any metric, there are issues with this, such as not controlling for increased content, but let's keep things simple for now). If our change in download speed kept the same set of users, but they increased the number of videos they watched now that downloading them was quicker, VWpU is a reasonable metric. If we encourage a lot of new users to join, this is a problem.</p>
<p>To see why, let's say we have 10 people that watch 5 videos a month at the old download speeds. When the new downloads come out, those 10 people watch 25 videos a month, but 100 more causal viewers (who didn't watch anything when it took 20 minutes) decide to watch 2 videos a month. A naive way of calculating the VWpU gives</p>
<table>
<thead><tr>
<th>Download Time</th>
<th>10 engaged users</th>
<th>100 casual users</th>
<th>"Average"</th>
</tr>
</thead>
<tbody>
<tr>
<td>20 minutes</td>
<td>5 VWpU</td>
<td><em>MISSING</em></td>
<td>5.0 VWpU</td>
</tr>
<tr>
<td>2 minutes</td>
<td>25 VWpU</td>
<td>2 VWpU</td>
<td>4.1 VWpU</td>
</tr>
</tbody>
</table>
<p>Under the old system, the 100 causal users were not in my data set, so I didn't know I should zero them out, and my data set only had engaged users. When the barrier to entry was lower, my engaged users got more engaged, and some of the causal users started using my platform.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary-and-miscellaneous-points">Summary and miscellaneous points<a class="anchor-link" href="#Summary-and-miscellaneous-points">¶</a></h2><p>YouTube decrease the size of their download player by 92%, which should reduce download times by (approximately) the same factor. However, they saw the average download time go <em>up</em> dramatically instead. Separating out the different geographic regions (which roughly align with "high bandwidth" and "low bandwidth"), every single region saw a <em>decrease</em> in average time. The reason for the global increase was the regions with the slowest internet saw the greatest increase in the number of videos watched, once the download speed improved.</p>
<ul>
<li>Be careful of selection bias -- especially the bias of who chooses to use your product, and how frequently. It is hard to measure the people who are <em>not</em> interacting with your product.</li>
<li>When groups behave differently, it is often worthwhile to monitor the metrics on each group.</li>
<li>Make sure to measure what matters. If we looked at the number of videos watched, we would have seen a massive spike in this metric instead.</li>
<li>Be aware of "missing data" metrics. A metric like average number of videos watched <em>per user</em> can be misleading if you open up to more causal users.</li>
<li>Behavior of the overall average vs the behavior of subgroups is surprisingly subtle (even in cases where the population is fixed). </li>
</ul>
<p>One thing <strong>not</strong> to take away from this article is the idea that stratifying your metrics (i.e. looking at the groups) is always the right approach. It was this time, but it isn't always the case! <a href="https://statmodeling.stat.columbia.edu/2009/12/03/simpsons_parado/">Gelman</a> has an example of unemployment where the aggregate numbers are more relevant. How to decide whether to stratify or not will be discussed in the article on <a href="/simpsons-paradox">Simpson's paradox</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a class="anchor-link" href="#References">¶</a></h2><h3 id="Internal-pages">Internal pages<a class="anchor-link" href="#Internal-pages">¶</a></h3><ul>
<li><a href="/simpsons-paradox">Simpson's Paradox</a></li>
</ul>
<h3 id="External-pages">External pages<a class="anchor-link" href="#External-pages">¶</a></h3><ul>
<li><a href="https://blog.chriszacharias.com/page-weight-matters">"Page weight matters"</a> by Chris Zacharias. This is a blog post by the author of the HTML video player.</li>
<li><a href="https://royal.pingdom.com/page-load-time-really-affect-bounce-rate/">"Does Page Load Time Really Affect Bounce Rate?"</a>, a newer article (2018) than 2009, but indicates importance of getting page load speed under 2 seconds.</li>
<li><a href="https://unbounce.com/landing-pages/7-page-speed-stats-for-marketers/">"7 Page Speed Stats For Marketers"</a></li>
<li><a href="https://statmodeling.stat.columbia.edu/2009/12/03/simpsons_parado/">"Simpson's Paradox not always such a paradox</a></li>
</ul>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

            </section>

            <section class="post-info">
                <div class=a"post-share">
                    <a class="twitter" href="https://twitter.com/share?text=How can reducing page memory size increase download times?&amp;url=https://kiwidamien.github.io/how-can-reducing-page-memory-size-increase-download-times.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://kiwidamien.github.io/how-can-reducing-page-memory-size-increase-download-times.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=https://kiwidamien.github.io/how-can-reducing-page-memory-size-increase-download-times.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://kiwidamien.github.io/tag/metrics.html">Metrics</a><a href="https://kiwidamien.github.io/tag/simpsons-paradox.html">Simpson&#39;s paradox</a><a href="https://kiwidamien.github.io/tag/aggregation.html">aggregation</a><a href="https://kiwidamien.github.io/tag/confounding.html">confounding</a>                </aside>

                <div class="clear"></div>

                <aside class="post-author">
                        <figure class="post-author-avatar">
                            <img src="../assets/images/avatar.png" alt="Damien martin" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="https://kiwidamien.github.io/author/damien-martin.html">Damien martin</a></h4>
                            <p class="post-author-about">I am a data scientist with an interest in what drives the world. Background in Physics, Math, and Computer Science. Interested in Algorithms, Games, Books, Music, and Martial Arts. That is, when I am not off taking pictures somewhere! </p>
                            <span class="post-author-location"><i class="ic ic-location"></i> USA</span>
                            <span class="post-author-website"><a href="http://kiwidamien.github.io"><i class="ic ic-link"></i> Website</a></span>
                    </div>
                    <div class="clear"></div>
                </aside>

                </section>


                <aside class="post-nav">
                    <a class="post-nav-prev" href="https://kiwidamien.github.io/pathological-demand-with-flights-using-instrumental-variables.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-right"></i>
                                <h2 class="post-nav-title">Pathological demand with flights - using instrumental variables</h2>
                            <p class="post-nav-excerpt">Man predictive models learn correlations between your features and your target, and...</p>
                        </section>
                    </a>
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>
  
  </section>

  <script type="text/javascript" src="https://kiwidamien.github.io/theme/js/script.js"></script>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-131671634-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
</body>

</html>